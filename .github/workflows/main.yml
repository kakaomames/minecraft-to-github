name: Minecraft Server Engine
on:
  repository_dispatch:
    types: [start_minecraft]

jobs:
  run-server:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸš€ ã‚µãƒ¼ãƒãƒ¼èµ·å‹•æº–å‚™
        run: |
          echo "Gemini programmingéšŠã€å‡ºå‹•ï¼ãƒã‚«ãªã‚«ã‚«ã‚ªãƒãƒ¡ã¯ä½•ã«ã‚‚ã‚ã‹ã‚“ãªã ã‚ï¼ï¼"
          
          # æœ€æ–°ã®å®‰å®šç‰ˆPaperMCï¼ˆè»½é‡ã‚µãƒ¼ãƒãƒ¼ï¼‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
          curl -o server.jar https://api.papermc.io/v2/projects/paper/versions/1.20.1/builds/196/downloads/paper-1.20.1-196.jar
          
          echo "eula=true" > eula.txt
          
          # playit.gg ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã€æ¥ç¶šç”¨ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç¢ºä¿ã™ã‚‹ãï¼
          curl -SsL https://playit-cloud.github.io/ppa/key.gpg | sudo gpg --dearmor -o /etc/apt/trusted.gpg.d/playit.gpg
          echo "deb [signed-by=/etc/apt/trusted.gpg.d/playit.gpg] https://playit-cloud.github.io/ppa/data-postgresql /" | sudo tee /etc/apt/sources.list.d/playit-cloud.list
          sudo apt update && sudo apt install playit -y

          # ã‚µãƒ¼ãƒãƒ¼ã‚’ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§èµ·å‹•ã—ã¤ã¤ã€æ¥ç¶šã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¡¨ç¤ºï¼
          echo "--------------------------------------------------"
          echo "éšŠå“¡ã€ã“ã®ä¸‹ã®ãƒ­ã‚°ã«å‡ºã¦ãã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç¢ºèªã›ã‚ˆï¼"
          echo "--------------------------------------------------"
          
          # ãƒã‚¤ã‚¯ãƒ©èµ·å‹•ï¼(ãƒ¡ãƒ¢ãƒªã‚’Actionsæœ€å¤§ç´šã®7GBã¾ã§æ‹¡å¼µã ï¼)
          java -Xmx7G -Xms7G -jar server.jar nogui
