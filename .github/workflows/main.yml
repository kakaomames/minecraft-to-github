name: Minecraft Server Engine
on:
  repository_dispatch:
    types: [start_minecraft]

jobs:
  run-server:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸš€ ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼†ãƒˆãƒ³ãƒãƒ«é–‹é€š
        run: |
          echo "Gemini programmingéšŠã€playitæ¥ç¶šãƒ•ã‚§ãƒ¼ã‚ºé–‹å§‹ï¼"
          
          # 1. ã‚µãƒ¼ãƒãƒ¼æœ¬ä½“ã®æº–å‚™
          curl -o server.jar https://api.papermc.io/v2/projects/paper/versions/1.20.1/builds/196/downloads/paper-1.20.1-196.jar
          echo "eula=true" > eula.txt
          
          # 2. playitæœ¬ä½“ã®æº–å‚™
          curl -SsL -o playit https://github.com/playit-cloud/playit-agent/releases/latest/download/playit-linux-amd64
          chmod +x playit

          # 3. playitã‚’ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§èµ·å‹•
          # ã“ã‚Œã§ã‚µã‚¤ãƒˆå´ã®ã€ŒWaiting...ã€ãŒã€ŒConnectedã€ã«å¤‰ã‚ã‚‹ã¯ãšã ï¼
          echo "ãƒˆãƒ³ãƒãƒ«æ¥ç¶šã‚’é–‹å§‹ã—ã¾ã™..."
          ./playit run & 
          
          # 4. å°‘ã—å¾…ã£ã¦ã‹ã‚‰ãƒã‚¤ã‚¯ãƒ©ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
          sleep 10
          echo "ãƒã‚¤ã‚¯ãƒ©ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ã¾ã™ï¼"
          java -Xmx7G -Xms7G -jar server.jar nogui
          help
